import{r as m,b as e}from"./vendor-9a24f32e.js";import{F as x,a as v,b as T,E as D}from"./formik.esm-6723d0e7.js";import{c as R,a as $,b as I,d as q}from"./index.esm-41945323.js";import{b as A,c as F,a as M,T as W}from"./tabler-icons-react-fe0da12b.js";import{u as w,b as f}from"./index-6fd738e1.js";import{V as B,B as P,m as O,I as V,W as c,X as p,Y as H,l as L,a as N,d as h,Z as X,$ as Y,a0 as _,a1 as K,a2 as U}from"./mui-c7c5f84b.js";import"./IconCoin-68b6e027.js";import"./IconUser-373a8598.js";import"./IconChevronRight-c883d475.js";const Z=r=>{const o=W[r];return o?e.createElement(o,null):e.createElement(M,null)},j={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,borderRadius:2},z=(()=>{const r=new Date,o=r.getFullYear(),d=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0");return`${o}-${d}-${i}`})(),G={amount:"",remark:"",CategoryId:"",date:z,type:!1},J=R({amount:$().required("Required").min(.1,"Must be at least 0.1"),remark:I().optional(),CategoryId:I().required("Required"),date:q().required("Required")});function ie({open:r,onClose:o,getExpenses:d}){const i=w(),[g,y]=m.useState([]),[C,u]=m.useState(!1),[k,E]=m.useState(""),b=()=>{u(!1)};m.useEffect(()=>{localStorage.getItem("accessToken")?f.get("http://localhost:3001/cate/viewAll",{headers:{accessToken:localStorage.getItem("accessToken")}}).then(n=>{n.data&&y(n.data.cateexpense)}).catch(n=>{const t=n.response?n.response.data.message:n.message;E(t),u(!0)}):i("/auth/login")},[i]);const S=n=>{f.post("http://localhost:3001/trans/",n,{headers:{accessToken:localStorage.getItem("accessToken")}}).then(t=>{if(console.log("Server response:",t.data),t.data&&t.data.trans){const a=g.find(s=>s.id===n.CategoryId),l={...t.data.trans,Category:{name:(a==null?void 0:a.name)||"Unknown",Icon:(a==null?void 0:a.Icon)||{icon_class:"IconHelp"}}};d(l),o()}}).catch(t=>{console.error("Error submitting expense:",t);const a=t.response?t.response.data.message:t.message;E(a),u(!0)})};return e.createElement(B,{open:r,onClose:o},e.createElement(P,{sx:j},e.createElement(O,{variant:"h6",component:"h2",gutterBottom:!0},"Add Expense"),e.createElement(V,{onClick:o,sx:{position:"absolute",top:16,right:16}},e.createElement(A,null)),e.createElement(x,{initialValues:G,onSubmit:S,validationSchema:J},({handleChange:n,values:t,errors:a,touched:l})=>e.createElement(v,{className:"formContainer"},e.createElement(c,{fullWidth:!0,margin:"normal"},e.createElement(p,{name:"amount",type:"number",label:"Amount",variant:"outlined",onChange:n,value:t.amount,error:l.amount&&!!a.amount,helperText:l.amount&&a.amount,inputProps:{"aria-label":"Amount"}})),e.createElement(c,{fullWidth:!0,margin:"normal"},e.createElement(H,{id:"CategoryId"},"Category"),e.createElement(T,{as:L,name:"CategoryId",label:"Category",labelId:"CategoryId",variant:"outlined",displayEmpty:!0,error:l.CategoryId&&!!a.CategoryId},g.map(s=>e.createElement(N,{key:s.id,value:s.id},Z(s.Icon.icon_class),s.name))),e.createElement(D,{name:"CategoryId",component:"div",style:{color:"red"}})),e.createElement(c,{fullWidth:!0,margin:"normal"},e.createElement(p,{name:"date",type:"date",label:"Date",variant:"outlined",InputLabelProps:{shrink:!0},onChange:n,value:t.date,error:l.date&&!!a.date,helperText:l.date&&a.date,inputProps:{"aria-label":"Date"}})),e.createElement(c,{fullWidth:!0,margin:"normal"},e.createElement(p,{name:"remark",label:"Remark (optional)",variant:"outlined",onChange:n,value:t.remark,inputProps:{"aria-label":"Remark"}})),e.createElement(h,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,startIcon:e.createElement(F,null)},"Add Expense"))),e.createElement(X,{open:C,onClose:b},e.createElement(Y,null),e.createElement(_,null,e.createElement(K,null,k)),e.createElement(U,null,e.createElement(h,{onClick:b,color:"primary"},"OK")))))}export{ie as default};
