import{r as i,b as o}from"./vendor-9a24f32e.js";import{P as ce}from"./PageContainer-9d3d18ee.js";import{C as me}from"./react-apexcharts.min-717a880d.js";import{D as B}from"./DashboardCard-365a522d.js";import{g as X}from"./func12m-131c3f32.js";import{u as _,b as F}from"./index-6fd738e1.js";import{u as Z,G as h,l as ee,a as te,m as f,B as b,n as pe,o as J,p as oe,S,q as M,r as w,s as I,t as E,v as R,_ as $,w as u,x as T,y as k,z as N,E as ue,F as de,H as ge,J as fe,A as xe}from"./mui-c7c5f84b.js";import{I as he,a as ne,T as se}from"./tabler-icons-react-fe0da12b.js";import"./IconCoin-68b6e027.js";import"./IconUser-373a8598.js";import"./IconChevronRight-c883d475.js";const Ce=()=>{let e=_();const t=Z(),n="rgb(93, 135, 255)",s="rgb(73,190,255)",a=t.palette.mode==="dark"?"rgba(255,255,255,0.8)":"#2A3547",[r,m]=i.useState(0),[p,g]=X(),[x,A]=i.useState(g),[C,D]=i.useState([]),[v,U]=i.useState([]),[P,L]=i.useState(null),c=l=>{A(l)},z=(l,d)=>m(d);i.useEffect(()=>{localStorage.getItem("accessToken")?F.get(`http://localhost:3001/trans/viewAll?mth=${x}`,{headers:{accessToken:localStorage.getItem("accessToken")}}).then(l=>{const d=l.data.monthly.filter(O=>O.type===!0),H=l.data.monthly.filter(O=>O.type===!1);U(d),D(H)}).catch(l=>{L(l.response?l.response.data.message:"Server Error")}):e("/auth/login")},[x,e]);const W={income:{labels:(v==null?void 0:v.map(l=>{var d;return(d=l==null?void 0:l.Category)==null?void 0:d.name}))||[],values:(v==null?void 0:v.map(l=>Number(l==null?void 0:l.totalAmount)))||[]},expenses:{labels:(C==null?void 0:C.map(l=>{var d;return(d=l==null?void 0:l.Category)==null?void 0:d.name}))||[],values:(C==null?void 0:C.map(l=>Number(l==null?void 0:l.totalAmount)))||[]}},y=r===0?W.income:W.expenses,le=()=>`#${Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}`,Y=y.labels.map((l,d)=>[n,s][d]||le()),ie={chart:{type:"donut",fontFamily:"'Plus Jakarta Sans', sans-serif;",toolbar:{show:!1},height:275},labels:y.labels,colors:Y,plotOptions:{pie:{donut:{size:"89%",background:"transparent",labels:{show:!0,name:{show:!0,offsetY:7},total:{show:!0,color:a,fontSize:"20px",fontWeight:"600",formatter:function(l){return`RM ${l.globals.seriesTotals.reduce((H,O)=>H+O,0).toFixed(2)}`}}}}}},dataLabels:{enabled:!1},stroke:{show:!1},legend:{show:!1},tooltip:{theme:"dark",fillSeriesColor:!1,y:{formatter:l=>`RM ${parseFloat(l).toFixed(2)}`}}};return o.createElement(h,{item:!0,xs:12},o.createElement(B,{title:"Transaction Overview",action:o.createElement(ee,{labelId:"month-dd",id:"month-dd",value:x,size:"small",onChange:l=>c(l.target.value),displayEmpty:!0},p.map(l=>o.createElement(te,{key:l,value:l},l)))},P&&o.createElement(f,{color:"error"},P),o.createElement(b,{sx:{borderBottom:1,borderColor:"divider",alignItems:"center",display:"flex",justifyContent:"center"}},o.createElement(pe,{value:r,onChange:z},o.createElement(J,{label:"Income"}),o.createElement(J,{label:"Expenses"}))),o.createElement(h,{container:!0,spacing:2,mt:1,p:2},o.createElement(h,{item:!0,xs:12,md:6},y.labels.length>0?o.createElement(me,{options:ie,series:y.values,type:"donut",height:"275px"}):o.createElement(f,{variant:"h6",color:"textSecondary",sx:{minHeight:275,maxHeight:275,overflowY:"auto"}},"No Transactions for ",r===0?"Income":"Expenses",".")),o.createElement(h,{item:!0,xs:12,md:6},o.createElement(oe,{sx:{minHeight:275,maxHeight:275,overflowY:"auto"}},o.createElement(S,{spacing:2},y.labels.length>0?y.labels.map((l,d)=>o.createElement(S,{direction:"row",spacing:2,alignItems:"center",key:d},o.createElement(b,{width:38,height:38,bgcolor:Y[d],display:"flex",alignItems:"center",justifyContent:"center",sx:{borderRadius:"7px"}},o.createElement(f,{display:"flex",alignItems:"center",justifyContent:"center"},o.createElement(he,{width:22}))),o.createElement(b,null,o.createElement(f,{variant:"h6",fontWeight:"600"},l),o.createElement(f,{variant:"subtitle2",color:"textSecondary"},"Amount: RM ",parseFloat(y.values[d]).toFixed(2))))):o.createElement(f,{variant:"body1",color:"textSecondary"},"No data available.")))))))},Ee=i.createContext({}),j=Ee;function Te(e){return M("MuiTimeline",e)}w("MuiTimeline",["root","positionLeft","positionRight","positionAlternate"]);const ve=["position","className"],ye=e=>{const{position:t,classes:n}=e,s={root:["root",t&&`position${E(t)}`]};return N(s,Te,n)},be=I("ul",{name:"MuiTimeline",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.position&&t[`position${E(n.position)}`]]}})({display:"flex",flexDirection:"column",padding:"6px 16px",flexGrow:1}),Se=i.forwardRef(function(t,n){const s=R({props:t,name:"MuiTimeline"}),{position:a="right",className:r}=s,m=$(s,ve),p=u({},s,{position:a}),g=ye(p),x=i.useMemo(()=>({position:a}),[a]);return T.jsx(j.Provider,{value:x,children:T.jsx(be,u({className:k(g.root,r),ownerState:p,ref:n},m))})}),Me=Se;function we(e){return M("MuiTimelineConnector",e)}w("MuiTimelineConnector",["root"]);const Ie=["className"],Re=e=>{const{classes:t}=e;return N({root:["root"]},we,t)},$e=I("span",{name:"MuiTimelineConnector",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({width:2,backgroundColor:(e.vars||e).palette.grey[400],flexGrow:1})),ke=i.forwardRef(function(t,n){const s=R({props:t,name:"MuiTimelineConnector"}),{className:a}=s,r=$(s,Ie),m=s,p=Re(m);return T.jsx($e,u({className:k(p.root,a),ownerState:m,ref:n},r))}),Ne=ke;function De(e){return M("MuiTimelineContent",e)}const Ae=w("MuiTimelineContent",["root","positionLeft","positionRight","positionAlternate"]),Oe=Ae,je=["className"],Ue=e=>{const{position:t,classes:n}=e,s={root:["root",`position${E(t)}`]};return N(s,De,n)},Pe=I(f,{name:"MuiTimelineContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${E(n.position)}`]]}})(({ownerState:e})=>u({flex:1,padding:"6px 16px",textAlign:"left"},e.position==="left"&&{textAlign:"right"})),Be=i.forwardRef(function(t,n){const s=R({props:t,name:"MuiTimelineContent"}),{className:a}=s,r=$(s,je),{position:m}=i.useContext(j),p=u({},s,{position:m||"right"}),g=Ue(p);return T.jsx(Pe,u({component:"div",className:k(g.root,a),ownerState:p,ref:n},r))}),G=Be;function _e(e){return M("MuiTimelineDot",e)}w("MuiTimelineDot",["root","filled","outlined","filledGrey","outlinedGrey","filledPrimary","outlinedPrimary","filledSecondary","outlinedSecondary"]);const Fe=["className","color","variant"],Le=e=>{const{color:t,variant:n,classes:s}=e,a={root:["root",n,t!=="inherit"&&`${n}${E(t)}`]};return N(a,_e,s)},ze=I("span",{name:"MuiTimelineDot",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.color!=="inherit"&&`${n.variant}${E(n.color)}`],t[n.variant]]}})(({ownerState:e,theme:t})=>u({display:"flex",alignSelf:"baseline",borderStyle:"solid",borderWidth:2,padding:4,borderRadius:"50%",boxShadow:(t.vars||t).shadows[1],margin:"11.5px 0"},e.variant==="filled"&&u({borderColor:"transparent"},e.color!=="inherit"&&u({},e.color==="grey"?{color:(t.vars||t).palette.grey[50],backgroundColor:(t.vars||t).palette.grey[400]}:{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main})),e.variant==="outlined"&&u({boxShadow:"none",backgroundColor:"transparent"},e.color!=="inherit"&&u({},e.color==="grey"?{borderColor:(t.vars||t).palette.grey[400]}:{borderColor:(t.vars||t).palette[e.color].main})))),He=i.forwardRef(function(t,n){const s=R({props:t,name:"MuiTimelineDot"}),{className:a,color:r="grey",variant:m="filled"}=s,p=$(s,Fe),g=u({},s,{color:r,variant:m}),x=Le(g);return T.jsx(ze,u({className:k(x.root,a),ownerState:g,ref:n},p))}),V=He;function Ge(e){return M("MuiTimelineOppositeContent",e)}const We=w("MuiTimelineOppositeContent",["root","positionLeft","positionRight","positionAlternate"]),re=We,Ye=["className"],Je=e=>{const{position:t,classes:n}=e,s={root:["root",`position${E(t)}`]};return N(s,Ge,n)},Ve=I(f,{name:"MuiTimelineOppositeContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${E(n.position)}`]]}})(({ownerState:e})=>u({padding:"6px 16px",marginRight:"auto",textAlign:"right",flex:1},e.position==="left"&&{textAlign:"left"})),ae=i.forwardRef(function(t,n){const s=R({props:t,name:"MuiTimelineOppositeContent"}),{className:a}=s,r=$(s,Ye),{position:m}=i.useContext(j),p=u({},s,{position:m||"left"}),g=Je(p);return T.jsx(Ve,u({component:"div",className:k(g.root,a),ownerState:p,ref:n},r))});ae.muiName="TimelineOppositeContent";const q=ae;function qe(e){return M("MuiTimelineItem",e)}w("MuiTimelineItem",["root","positionLeft","positionRight","positionAlternate","missingOppositeContent"]);const Ke=["position","className"],Qe=e=>{const{position:t,classes:n,hasOppositeContent:s}=e,a={root:["root",`position${E(t)}`,!s&&"missingOppositeContent"]};return N(a,qe,n)},Xe=I("li",{name:"MuiTimelineItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${E(n.position)}`]]}})(({ownerState:e})=>u({listStyle:"none",display:"flex",position:"relative",minHeight:70},e.position==="left"&&{flexDirection:"row-reverse"},e.position==="alternate"&&{"&:nth-of-type(even)":{flexDirection:"row-reverse",[`& .${Oe.root}`]:{textAlign:"right"},[`& .${re.root}`]:{textAlign:"left"}}},!e.hasOppositeContent&&{"&:before":{content:'""',flex:1,padding:"6px 16px"}})),Ze=i.forwardRef(function(t,n){const s=R({props:t,name:"MuiTimelineItem"}),{position:a,className:r}=s,m=$(s,Ke),{position:p}=i.useContext(j);let g=!1;i.Children.forEach(s.children,D=>{ue(D,["TimelineOppositeContent"])&&(g=!0)});const x=u({},s,{position:a||p||"right",hasOppositeContent:g}),A=Qe(x),C=i.useMemo(()=>({position:x.position}),[x.position]);return T.jsx(j.Provider,{value:C,children:T.jsx(Xe,u({className:k(A.root,r),ownerState:x,ref:n},m))})}),K=Ze;function et(e){return M("MuiTimelineSeparator",e)}w("MuiTimelineSeparator",["root"]);const tt=["className"],ot=e=>{const{classes:t}=e;return N({root:["root"]},et,t)},nt=I("div",{name:"MuiTimelineSeparator",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"column",flex:0,alignItems:"center"}),st=i.forwardRef(function(t,n){const s=R({props:t,name:"MuiTimelineSeparator"}),{className:a}=s,r=$(s,tt),m=s,p=ot(m);return T.jsx(nt,u({className:k(p.root,a),ownerState:m,ref:n},r))}),Q=st,rt=e=>{const t=se[e];return t?o.createElement(t,null):o.createElement(ne,null)};function at(){const[e,t]=i.useState([]),[n,s]=i.useState("");let a=_();return i.useEffect(()=>{localStorage.getItem("accessToken")?F.get("http://localhost:3001/trans/viewAll",{headers:{accessToken:localStorage.getItem("accessToken")}}).then(r=>{r.data?t(r.data.latestTrans):alert("Unexpected response format. Please try again.")}).catch(r=>{r.response?s(r.response.data.message):s("Server Error")}):a("/auth/login")},[a]),o.createElement(B,{title:"Recent Transactions",sx:{p:0,mb:2,width:"100%",overflow:"auto"}},o.createElement(de,null,o.createElement(Me,{className:"theme-timeline",sx:{p:0,mb:"-40px",minHeight:"350px","& .MuiTimelineConnector-root":{width:"1px",backgroundColor:"#efefef"},[`& .${re.root}`]:{flex:.5,paddingLeft:0,textAlign:"left",display:"flex",justifyContent:"flex-start",alignItems:"flex-start"},"& .MuiTimelineItem-root":{display:"flex",justifyContent:"space-between"},"& .MuiTimelineContent-root":{flex:1}}},e.length===0?o.createElement(K,null,o.createElement(q,null),o.createElement(Q,null,o.createElement(V,{color:"primary",variant:"outlined"}),o.createElement(Ne,null)),o.createElement(G,null,"No Transaction")):e.map((r,m)=>o.createElement(K,{key:m},o.createElement(q,{style:{fontSize:"0.75rem"}},r.date),o.createElement(Q,null,o.createElement(V,{color:"primary",variant:"outlined"})),o.createElement(G,{style:{fontSize:"0.8rem"}},rt(r.Category.Icon.icon_class),r.remark?r.remark:r.Category.name),o.createElement(G,{style:{textAlign:"right",fontSize:"0.8rem"}},r.type===!0?"+":"-"," RM ",r.amount))))))}const lt=()=>{let e=_();const t=Z(),[n,s]=i.useState([]);return i.useEffect(()=>{const a=localStorage.getItem("accessToken");if(!a){e("/auth/login");return}F.get("http://localhost:3001/budget/viewAll",{headers:{accessToken:a}}).then(r=>{r.data&&s(r.data.budgetTrans)}).catch(r=>{setErrorMsg(r.message)})},[e]),o.createElement(B,{title:"Yearly Budget Overview",sx:{p:0,mb:2,width:"100%"}},o.createElement(b,{sx:{minHeight:"310px"}},o.createElement(S,{spacing:2},n.length===0?o.createElement(f,{variant:"subtitle1",align:"center",color:"textSecondary"},"No Budgets Available"):n.map((a,r)=>{const m=a.totalSpent/a.amount*100,p=Math.min(m,100);return o.createElement(b,{key:r},o.createElement(S,{direction:"row",justifyContent:"space-between",alignItems:"center"},o.createElement(f,{variant:"subtitle1"},a.remark?a.remark:a.Category.name),o.createElement(f,{variant:"subtitle2",color:"textSecondary"},"RM ",a.totalSpent.toFixed(2)," / RM ",a.amount)),o.createElement(ge,{variant:"determinate",value:p,sx:{height:10,borderRadius:5,backgroundColor:t.palette.grey[300],"& .MuiLinearProgress-bar":{backgroundColor:p>75?t.palette.error.main:t.palette.primary.main}}}))}))))},it=e=>{const t=se[e];return t?o.createElement(t,null):o.createElement(ne,null)},ct=()=>{const[e,t]=i.useState(null),[n,s]=X(),[a,r]=i.useState(s),[m,p]=i.useState(0),[g,x]=i.useState(0),[A,C]=i.useState(0),[D,v]=i.useState(null),U=_(),P=c=>{r(c),t(null)};i.useEffect(()=>{localStorage.getItem("accessToken")?F.get(`http://localhost:3001/trans/viewAll?mth=${a}`,{headers:{accessToken:localStorage.getItem("accessToken")}}).then(c=>{c.data?(x(c.data.ttlIncome),p(c.data.ttlExpense),C(parseFloat(c.data.ttlIncome-c.data.ttlExpense).toFixed(2))):alert("Unexpected response format. Please try again.")}).catch(c=>{v(c.response?c.response.data.message:"Server Error")}):U("/auth/login")},[a,U]);const L=[{title:"Total Balance",subtitle:"Monthly Balance",amount:A,color:"rgb(93, 135, 255)",lightcolor:"rgb(236,242,255)",icon:"IconMoneybag"},{title:"Income",subtitle:"Monthly Income",amount:g,color:"rgb(102,187,106)",lightcolor:"rgb(232,245,233)",icon:"IconReceiptTax"},{title:"Expenses",subtitle:"Monthly Expenses",amount:m,color:"rgb(250,137,107)",lightcolor:"rgb(253,237,232)",icon:"IconCreditCardPay"}];return o.createElement(B,{title:"Monthly Balance",sx:{padding:"20px"},action:o.createElement(ee,{labelId:"month-dd",id:"month-dd",value:a,size:"small",onChange:c=>P(c.target.value)},n.map(c=>o.createElement(te,{key:c,value:c},c)))},D&&o.createElement(f,{color:"error"},D),o.createElement(S,{spacing:3,mt:2},L.map((c,z)=>o.createElement(fe,{key:z,sx:{backgroundColor:c.lightcolor,boxShadow:2}},o.createElement(oe,null,o.createElement(S,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center"},o.createElement(S,{direction:"row",alignItems:"center",spacing:2},o.createElement(xe,{variant:"rounded",sx:{bgcolor:c.lightcolor,color:c.color,width:60,height:70}},it(c.icon)),o.createElement(b,null,o.createElement(f,{variant:"h6",mb:"4px"},c.title),o.createElement(f,{variant:"subtitle2",color:"textSecondary"},c.subtitle))),o.createElement(f,{variant:"subtitle2",fontWeight:"600",color:c.title==="Expenses"?"error":"primary"},"RM ",c.amount)))))))},vt=()=>o.createElement(ce,{title:"Dashboard",description:"this is Dashboard"},o.createElement(b,null,o.createElement(h,{container:!0,spacing:3},o.createElement(h,{item:!0,xs:12,lg:7},o.createElement(Ce,null)),o.createElement(h,{item:!0,xs:12,lg:5},o.createElement(h,{container:!0,spacing:3},o.createElement(h,{item:!0,xs:12},o.createElement(ct,null)))),o.createElement(h,{item:!0,xs:12,lg:6},o.createElement(at,null)),o.createElement(h,{item:!0,xs:12,lg:6},o.createElement(lt,null)))));export{vt as default};
